<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Responsive Admin Dashboard Template">
<meta name="keywords" content="admin,dashboard">
<meta name="author" content="stacks">
<!-- The above 6 meta tags *must* come first in the head;any other head content must come *after* these tags --><!-- Title -->
<title>成员管理</title>
   {% load static %}
<!-- Styles -->
<link href="https://fonts.googleapis.com/css?family=Poppins:400,500,700,800&display=swap" rel="stylesheet">
<link href="/statics/assets_tech/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="/statics/assets_tech/plugins/font-awesome/css/all.min.css" rel="stylesheet">
<link href="/statics/assets_tech/plugins/perfectscroll/perfect-scrollbar.css" rel="stylesheet">
<!-- Theme Styles -->
<link href="/statics/assets_tech/css/main.min.css" rel="stylesheet">
<link href="/statics/assets_tech/css/custom.css" rel="stylesheet">
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --><!-- WARNING:Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
</head>
<body>
<div class='loader'>
  <div class='spinner-grow text-primary' role='status'> <span class='sr-only'>Loading...</span> </div>
</div>
<div class="page-container">
  <div class="page-header">
    <nav class="navbar navbar-expand-lg d-flex justify-content-between">
      <div class="" id="navbarNav">
        <ul class="navbar-nav" id="leftNav">
          <li class="nav-item"><a class="nav-link" id="sidebar-toggle" href="#"><i data-feather="arrow-left"></i></a></li>
          <li class="nav-item"><a class="nav-link" href="/indextech/">主页</a></li>
           <li class="nav-item"><a class="nav-link" href="/userset/">设置</a></li>
          <li class="nav-item"><a class="nav-link" href="/index/">切换账号</a></li>
        </ul>
      </div>
      <div class="logo"><a class="navbar-brand" href="index.html"></a></div>
      <div class="" id="headerNav">
        <ul class="navbar-nav">
          <li class="nav-item dropdown"><a class="nav-link search-dropdown" href="#" id="searchDropDown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i data-feather="search"></i></a>
            <div class="dropdown-menu dropdown-menu-end dropdown-lg search-drop-menu" aria-labelledby="searchDropDown">
              <form>
                <input class="form-control" type="text" placeholder="Type something.." aria-label="Search">
              </form>
              <h6 class="dropdown-header">Recent Searches</h6>
              <a class="dropdown-item" href="#">charts</a><a class="dropdown-item" href="#">new orders</a><a class="dropdown-item" href="#">file manager</a><a class="dropdown-item" href="#">new users</a></div>
          </li>
          <li class="nav-item dropdown"><a class="nav-link notifications-dropdown" href="#" id="notificationsDropDown" role="button" data-bs-toggle="dropdown" aria-expanded="false">{{notice_list.0.notice_count}}</a>
            <div class="dropdown-menu dropdown-menu-end notif-drop-menu" aria-labelledby="notificationsDropDown">
              <h6 class="dropdown-header">通知</h6>
              {% if notice_list.0.notice_count != 0 %}
                {% for item in notice_list%}
              <a href="#">
              <div class="header-notif">
                <div class="notif-image"><span class="notification-badge bg-info text-white"><i class="fas fa-bullhorn"></i></span></div>
                <div class="notif-text">
                  <p class="bold-notif-text">来自:{{item.send_role}}{{item.send_name}}</p>
                </div>
                <div class="notif-text">
                  <h4 class="bold-notif-text"><code>{{item.notice_title}}</code></h4>
                </div>
                <div class="notif-text">
                  <h4 class="bold-notif-text">{{item.notice_content}}</h4>
                  <small>{{item.notice_time}}</small></div>
              </div>
              </a>
                {% endfor %}
              {% endif %}
            </div>
          </li>
          <li class="nav-item dropdown"><a class="nav-link profile-dropdown" href="#" id="profileDropDown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><img src="/statics/assets_tech/images/avatars/profile-image.png" alt=""></a>
            <div class="dropdown-menu dropdown-menu-end profile-drop-menu" aria-labelledby="profileDropDown">
              <a class="dropdown-item" href="#"><i data-feather="user"></i>个人简介</a>
              <a class="dropdown-item" href="#"><i data-feather="inbox"></i>消息</a>
              <a class="dropdown-item" href="#"><i data-feather="edit"></i>活动<span class="badge rounded-pill bg-success">12</span></a>
              <a class="dropdown-item" href="#"><i data-feather="check-circle"></i>任务</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#"><i data-feather="settings"></i>设置</a><a class="dropdown-item" href="#"><i data-feather="unlock"></i>锁屏</a><a class="dropdown-item" href="#"><i data-feather="log-out"></i>登出</a></div>
          </li>
        </ul>
      </div>
    </nav>
  </div>
  <div class="page-sidebar">
    <ul class="list-unstyled accordion-menu">
      <li class="sidebar-title">Main </li>
      <li ><a href="/indextech/"><i data-feather="home"></i>学习数据</a></li>
      <li class="sidebar-title">Apps </li>
      <li><a href="/feedbackemail/"><i data-feather="inbox"></i>反馈邮箱</a></li>
      <li><a href="/enter_talking/"><i data-feather="message-circle"></i>小组讨论区</a></li>
      <li><a href="/teacher_eva/"><i data-feather="edit"></i>教师评价</a></li>
      <li><a href="/data_analysis/"><i data-feather="pie-chart"></i>评论分析</a></li>
      <li ><a href="/mark_assess/"><i data-feather="edit"></i>成绩评分</a></li>
      <li class="active-page"><a href="index.html"><i data-feather="edit"></i>小组管理<i class="fas fa-chevron-right dropdown-icon"></i></a>
        <ul class="">
          <li><a href="/stumanage/" class="active" style="font-weight:bold"><i class="far fa-circle"></i>成员管理</a></li>
          <li><a href="/scoremanage/"><i class="far fa-circle"></i>成绩管理</a></li>
        </ul>
      </li>
      <li><a href="#"><i data-feather="edit"></i>评价管理<i class="fas fa-chevron-right dropdown-icon"></i></a>
        <ul class="">
          <li><a href="/tech_eva_manage/?eva=stu"><i class="far fa-circle"></i>学生自评</a></li>
          <li><a href="/tech_eva_manage/?eva=group"><i class="far fa-circle"></i>小组评价</a></li>
          <li><a href="/tech_eva_manage/?eva=groups"><i class="far fa-circle"></i>小组互评</a></li>
          <li><a href="/tech_eva_manage/?eva=member"><i class="far fa-circle"></i>成员互评</a></li>
          <li><a href="/tech_eva_manage/?eva=teacher"><i class="far fa-circle"></i>教师评价</a></li>
        </ul>
      </li>
    </ul>
  </div>
  <div class="page-content">
    <div class="main-wrapper">
      <div class="row">



        {% for group in group_count%}
        <div class="col-md-6 col-xl-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">第{{group.group_id}}小组: {{group.topic}}</h5>
              <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center">小组人数 <span class="badge bg-primary rounded-pill">{{group.group_count}}</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center">已指定角色人数<span class="badge bg-primary rounded-pill">{{group.hasbeen_spec|length}}</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center">尚未指定角色人数 <span class="badge bg-primary rounded-pill">{{group.nothasbeen_spec|length}}</span></li>
              </ul>
              {% if group.group_count == 5 %}
              <button  style="margin-top:10px;" type="button"   class="btn btn-dark">无需添加</button>
              {% else %}
              <button id="yulan" style="margin-top:10px;" type="button" data-bs-toggle="modal" data-bs-target="#addnewmem" onclick="addnewstu({{group.group_id}})" class="btn btn-primary">添加成员</button>
              {% endif %}
              {% if group.nothasbeen_spec|length == 0 %}
              <button  style="margin-top:10px;" type="button"   class="btn btn-dark">无需指定</button>
              {% else %}
              <button id="tijiaoshuju" onclick="onloadinfo({{group.group_id}})" style="margin-top:10px;" type="button" data-bs-toggle="modal" data-bs-target="#addnewrole"  class="btn btn-primary">指定角色</button>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
        <!-- Modal2-添加成员 -->
        <div class="modal fade" id="addnewmem" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="datasubmitLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="addnewmemLabel">添加新成员</h5>
                      <button id="close" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                     <div class="modal-body">
                      <label for="addstunum" class="form-label">学号</label>
                      <select class="form-select" id="addstunum" required>
                        <option selected disabled value="">选择学号...</option>
                        {%  for rows in nonlist %}
                        <option value="{{ rows.fields.num }}">{{ rows.fields.num }}</option>
                         {% endfor %}
                      </select>
                      <div class="invalid-feedback">Please select a valid state.</div>
                       <div class="mb-3">
                      <label for="stu_num" class="form-label">姓名</label>
                      <input type="text" class="form-control" id="new_name" name="new_name" readonly="true">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">班级</label>
                      <input type="text" class="form-control" id="new_grade" name="new_grade" readonly="true">
                      </div>
                    <div class="modal-footer">
                      <button id="close2" type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                      <button type="button" id="adddata" class="btn btn-primary" onclick="addnewmember()">添加</button>
                    </div>
                  </div>

                </div>
              </div>


        </div>

      <!-- Modal3-指定成员角色 -->
      <div class="modal fade" id="addnewrole" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="datalookLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="onloadgroupLabel">指定角色</h5>
                      <button id="close" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <div class="mb-3">
                      <label for="choose_mem" class="form-label">请选择成员</label>
                        <select id="choose_mem" name="x_data" class="form-select" aria-label="Default select example">

                        </select>
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">姓名</label>
                      <input type="text" class="form-control" id="choose_name" name="new_name" readonly="true">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">班级</label>
                      <input type="text" class="form-control" id="choose_grade" name="new_grade" readonly="true">
                      </div>
                       <div class="mb-3">
                      <label for="choose_role" class="form-label">选择角色</label>
                        <select id="choose_role" name="choose_role" class="form-select" aria-label="Default select example">
                      </select>
                      </div>
                       <div class="modal-footer">
                      <button id="close3" type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                      <button id="dataview" type="button"  class="btn btn-primary" onclick="submitchooserole()">确定</button>
                               <!--onclick="submitinfo()"-->
                    </div>
                    </div>
                  </div>
                </div>
                </div>
            </div>
      <div class="row">
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">成员管理</h5>
              <p>展示小组成员基本信息，以及尚未分组的同学</p>
              <table id="zero-conf" class="display" style="width:100%" >
                <thead>
                  <tr>
                    <th>序号</th>
                    <th>学号</th>
                    <th>姓名</th>
                    <th>班级</th>
                    <th>组号</th>
                    <th>职位</th>
                    <th>##</th>
                  </tr>
                </thead>
                <tbody id="stuinfo" name="stuinfo">
                {%  for row in list %}
                 <tr>
              <td >{{ row.pk }}</td>
              <td id='bkid'>{{ row.fields.num }}</td>
              <td>{{ row.fields.name }}</td>
              <td>{{ row.fields.grade }}</td>
              <td>{{ row.fields.group_id }}</td>
              <td>{{ row.fields.group_role }}</td>
              <td class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="changeinfo()">
                修改
              </td>
            </tr>
        {% endfor %}
                </tbody>
                <tfoot>
                  <tr>
                    <th>序号</th>
                    <th>姓名</th>
                    <th>学号</th>
                    <th>班级</th>
                    <th>组号</th>
                    <th>职位</th>
                    <th>##</th>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>
      </div>
              <!-- Modal -->
              <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="staticBackdropLabel">修改状态</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form id="defaultForm"  method="post" name="stuinit">
                    <div class="modal-body">
                       {% csrf_token %}
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">学号</label>
                      <input type="text" class="form-control" id="stu_num" name="stu_num" aria-describedby="emailHelp">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">姓名</label>
                      <input type="text" class="form-control" id="stu_name" name="stu_name" aria-describedby="emailHelp">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">班级</label>
                      <input type="text" class="form-control" id="stu_grade" name="stu_grade" aria-describedby="emailHelp">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">组号</label>
                      <input type="text" class="form-control" id="stu_group" name="stu_group" aria-describedby="emailHelp">
                      </div>
                      <div class="mb-3">
                      <label for="stu_num" class="form-label">职务</label>
                        <select id="stu_po" name="stu_po" class="form-select" aria-label="Default select example">
                         <option value="尚未指定">尚未指定</option>
                         <option value="组长">组长</option>
                         <option value="组员">组员</option>
                         <option value="检察员">检察员</option>
                          <option value="记录员">记录员</option>
                           <option value="报告员">报告员</option>
                      </select>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                      <button type="button" onclick="submitinfo()" class="btn btn-primary">提交修改</button>
                    </div>
                    </form>
                  </div>
                </div>
              </div>
      <div class="row">
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">尚未分组的同学</h5>
              <p>展示尚未分组的同学的基本信息</p>
              <table id="nonzero-conf" class="display" style="width:100%" >
                <thead>
                  <tr>
                    <th>序号</th>
                    <th>学号</th>
                    <th>姓名</th>
                    <th>班级</th>
                    <th>组号</th>
                    <th>职位</th>
                    <th>##</th>
                  </tr>
                </thead>
                <tbody id="nonstuinfo" name="nonstuinfo">
                {%  for rows in nonlist %}
                 <tr>
                    <td >{{ rows.pk }}</td>
                    <td id='nonbkid'>{{ rows.fields.num }}</td>
                    <td>{{ rows.fields.name }}</td>
                     <td>{{ rows.fields.grade }}</td>
                     <td>{{ rows.fields.group_id }}</td>
                     <td>{{ rows.fields.group_role }}</td>
                  <td class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="changenoninfo()">
                      修改
                     </td>
                  </tr>
                {% endfor %}
                </tbody>
                <tfoot>
                  <tr>
                    <th>序号</th>
                    <th>姓名</th>
                    <th>学号</th>
                    <th>班级</th>
                    <th>组号</th>
                    <th>职位</th>
                    <th>##</th>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{{ nonlist|json_script:"nonlist" }}
<!-- Javascripts -->
<script src="/statics/assets_tech/plugins/jquery/jquery-3.4.1.min.js"></script>
<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="/statics/assets_tech/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="/statics/assets_tech/plugins/perfectscroll/perfect-scrollbar.min.js"></script>
<script src="/statics/assets_tech/plugins/DataTables/datatables.min.js"></script>
<script src="/statics/assets_tech/js/main.min.js"></script>
<script src="/statics/assets_tech/js/pages/datatables.js"></script>
<script src="/statics/techinit/manage.js"></script>
</body>
</html>